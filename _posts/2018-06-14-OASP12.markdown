---
layout:     post
title:      "OASP笔记 - 12"
subtitle:   "谱线的测量"
date:       2018-06-14
author:     "mingjie"
header-img: "img/post-bg-OASP11.jpg"
tags:
    - learning

---

手里有数据，心里不慌。上一章讲了谱线的轮廓，那么实际我们怎么去测这个轮廓呢？毕竟测到了才能推出下面几章的东西来，那么就要看看我们是拿什么东西来测量谱线轮廓，以及怎么还原谱线轮廓的了。

### 仪器

打住。我不是做仪器的，所以这块就不详细说了。要有轮廓肯定需要高色散光谱仪（虽然不同波段的高指的分辨率不一样，大家也都在吹自己的是高色散），光谱仪有分辨率公式$$(3.15)$$：

$$ \Delta \lambda = - \frac{W'}{f_\mathrm{coll}} \frac{d}{n} \cos{\alpha} \tag{12.1} $$

所以要减小$$ \Delta \lambda $$，提高分辨率，主要就是增大$$ f_\mathrm{coll} $$或者$$ n $$。所以要不就做得老长老长，要不就把反射光栅搞好，提升可用级数大小。

第二是每个光谱仪都需要有一个slit viewer，说白了就是导星镜。但是恒星的光都到狭缝里面去了，射到导星镜的光又怎么来呢？实际上是将狭缝的两边变成镜子，然后将狭缝稍微斜过来，就可以反光了。

### 仪器轮廓

仪器肯定会对谱线有致宽，这个致宽就叫仪器轮廓。假设我们有一个理想谱线，宽度可以忽略不计，它通过光谱仪之后的形状我们叫做$$ I(\lambda) $$。令理想光谱为$$ F(\lambda) $$，那么观测到的光谱$$ D(\lambda) $$自然是它们俩的卷积：

$$ \begin{align}
  D(\lambda) &= \int_{-\infty}^{\infty} I(\lambda-\lambda_0) F(\lambda_0) d\lambda_0\\
  &= I(\lambda) * F(\lambda) \tag{12.2}
  \end{align} $$

假设一个仪器轮廓是半高全宽为0.1埃的高斯函数，那么它的傅立叶变换还是一个高斯，只是宽度变为了10埃而已。

![]()
*这里有图*

在$$ \sigma $$域里面说话，观测到的光谱的傅立叶变换$$ d(\sigma) $$就是

$$ d(\sigma) = i(\sigma) f(\sigma) \tag{12.3}$$

这意味着仪器轮廓充当了一个低通滤波器的角色，把高$$ \sigma $$的信号滤掉了。从$$ \lambda $$域的角度来说，也就是卷积将光谱模糊/平滑了。这都是第二章的东西。

这看起来没什么，毕竟这么高分辨率的信号我们也看不到（后面还有采样在）。不过需要留意的一点是仪器轮廓还会改变谱线的深度和宽度。当然这也是显然的。

![]()
*这里有图*

### 复原

~~说完生光我们就该复圆了。~~

我们想求$$ f(\sigma) $$。这好说，把$$ (12.3) $$的$$ i(\sigma) $$除过去不就完了：

$$ f(\sigma) = d(\sigma) / i(\sigma) \tag{12.4} $$

为了处理不对称的轮廓，我们需要让上式中的三个量都为复数，则有：

$$ \begin{align}
  f_\mathrm{R}(\sigma) &= \frac{d_\mathrm{R}(\sigma)i_\mathrm{R}(\sigma) + d_\mathrm{I}(\sigma)i_\mathrm{I}(\sigma)}{i_\mathrm{R}(\sigma)^2 + i_\mathrm{I}(\sigma)^2} \\
  f_\mathrm{I}(\sigma) &= \frac{d_\mathrm{I}(\sigma)i_\mathrm{R}(\sigma) - d_\mathrm{R}(\sigma)i_\mathrm{I}(\sigma)}{i_\mathrm{R}(\sigma)^2 + i_\mathrm{I}(\sigma)^2} \\
\end{align} $$

最后做个逆傅立叶变换就好了。

### 噪声

问题在于噪声和另外一个东西。令噪声为$$ n(\sigma0) $$，则有

$$ d(\sigma) = d_0(\sigma) + n(\sigma) \tag{12.6} $$

所以

$$ f(\sigma) = \frac{d_0(\sigma)}{i(\sigma)} + \frac{n(\sigma)}{i(\sigma)} $$

噪声一般是高频的，而$$ i(\sigma) $$在高频处很小，所以仪器轮廓会加大噪声。

*这里有图*

那怎么办？这么搞的话光谱毛刺特别多。这个时候我们就要人为加入一个低通滤波器将高频的信号滤掉，反正主要是噪声。

我们将低通滤波器叫做$$ \phi(\sigma) $$，那么加入了滤波器的“真实”信号就是

$$ f_1(\sigma) = d(\sigma) \phi(\sigma) / i(\sigma) \tag{12.7} $$

我们希望$$ f_1(\sigma) $$与$$ f_0(\sigma) $$的区别尽量的小，所以我们需要将

$$ \epsilon = f_0(\sigma) - f_1(\sigma) = f_0(\sigma)[1-\phi(\sigma)] - n(\sigma)\phi(\sigma)/i(\sigma) $$

最小化。结论是

$$ \phi = \frac{1}{1+[n(\sigma)/d(\sigma)]^2} \tag{12.9} $$

噪声的傅立叶变换大小可以测量出来，令$$ B= <n(\sigma)> $$；$$ d(\sigma) $$可以用一个高斯函数来近似：$$ d(\sigma) \approx A 10^{-b_0^2\sigma^2} $$，所以

$$ \phi = \frac{1}{1+(B/A)^2 10^{-2b_0^2\sigma^2}} \tag{12.9} $$

就安排得明明白白了。

当然如果仪器轮廓太大或者信噪比太低那神仙都救不了，需要其他办法比如正向建模或者干脆data-driven的办法。

仪器轮廓会平滑掉一些高频信息，所以当仪器轮廓比较大的时候，采样频率可以适当降低；反之亦然。

#### 仪器轮廓的测量

可以通过汞灯、激光以及大气吸收线来测量。当仪器轮廓被狭缝宽度主导的时候，它与级数无关；但是最好还是用和恒星曝光时类似的设置来测量。

### 散射光

略写。主要是因为我们只考虑了仪器轮廓附近的波长范围，如果外面还有光进来的话就归为散射光。散射光主要集中在低$$ \sigma $$部分，抬高了$$ i(\sigma) $$所以会使得整个光谱被压低，所以散射光越小越好。

### 等值宽度

等值宽度定义为

$$ W = \int_{-\infty}^{\infty} \frac{F_\mathrm{c}-F_\mathrm{\nu}}{F_\mathrm{c}} \mathrm{d}\nu \tag{12.20} $$

但是实际上我们测得的是$$ D_\mathrm{\nu} = I(\lambda) * (F_\mathrm{c}-F_\mathrm{\nu}) $$，所以

$$ W_\mathrm{m} = \int_{-\lambda_0}^{\lambda_0} \frac{I(\lambda) * (F_\mathrm{c}-F_\mathrm{\nu})}{D_\mathrm{c}} \mathrm{d}\nu \tag{12.20} $$

这导致了我们有的时候不能覆盖整条谱线的范围，因为有别的线在；同时一般来说我们会低估$$ D_\mathrm{c} $$，导致$$ W_\mathrm{m} $$被高估。

### 谱线测量方法

在波长域我们可以测量谱线的半高全宽，以此表征比如自转之类的一些物理量。谱线的位置不对称性可以从谱线的中线看出来。

在$$ \sigma $$域我们可以方便地测量误差（看高$$ \sigma $$的弥散）、将卷积可视化（变成相乘了）等等。
